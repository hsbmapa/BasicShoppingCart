<html>

<body>

	<h2>SEC Assignment Login</h2>

	<form action="../server/login.php" method="POST">

		Username: <input type="text" name="username" id="username" maxlength="256">
		<br /><br />
		Password: <input type="password" name="password" id="password" maxlength="256">
		<br /><br />

		<button type="submit" onclick="encrypt_password()">Login</button>
	</form>

	<script src="js/sha256.js"></script>
	<script src="js/rsa.js"></script>
	<script type="text/javascript">

		function encrypt_password() {
			var password = document.getElementById('password').value;
			var hashed_password = SHA256.hash(password);
			var timestamp = Math.floor(new Date().getTime() / 1000);
			var encrypted = RSA_encryption(hashed_password + "&" + timestamp);
			document.getElementById('password').innerHTML = encrypted;
			document.getElementById('password').value = encrypted;
		}

	</script>

	<script type="text/javascript">

		var public_key = "-----BEGIN PUBLIC KEY-----MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAqkvKVoYmxMOrxgEn6l8PSTeE2/rKl7NZHam7yvvli+qcKMBPnXUJx6pjuZz3v/raH/od5IMLrWBXCqSdrd90u2GT/phZ3mF2Yaik0M41QZVPyIM1s3oWnpLNYqexAFxIZS1xjeRRo776pp8iFLBU4CvuxK8QR8MuvgXOX0S7O5zLv8EZPEf+tCr6n+NqXGAuIPXKo/aJm8RI5jGv+T64KgcbUfsZDjwh+HqgFtPRs2kUFls2YHQoSR+1u9gLmN67oq6gBhufjwtHjoHpzJ1ueiZXg/bDeANeTe7w5hxzE9qk8Y+csolmasNJwxjQj5vTiDUkmuj74TrNPXpLCdl+2xrLekc7CSjjIhp0RQ8Vc8HQdOFSkJQChbch3leM7baPPBOgCItLRlfBOwPvi7355No00j1AFnmpkSPa/az8PXq/28KGKimqnEHGosgvPy6FXlx5vZyUX8PZJB/b19wKbR+YIv48Iq57pdQDirXvFCJpNYC7KToW7uzUG5E9XO2Kn/B4O4e3oG9MQnmw/WDlDB2SJkr4eihR22WzkQNhlsbMCnxllUbXhXwH+98SnBqHbYgzjK9R54oWw2hE9yu5jhsgoRreLbopbjilnIWaAERhbbGniHALOMiBapjcjyCX85TjQ8FhjrDDP+mGXA0WwsxyMkqDcKxnvajWGvElgVcCAwEAAQ==-----END PUBLIC KEY-----";
		function RSA_encryption(message) {

			var encrypt = new JSEncrypt();
			encrypt.setPublicKey(public_key);
			var encrypted = encrypt.encrypt(message);

			return encrypted;
		}

	</script>

</body>

</html>