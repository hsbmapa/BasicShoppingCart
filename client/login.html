<html>

<body>

	<h2>SEC Assignment Login</h2>

	<form action="../server/login.php" method="POST">

		Username: <input type="text" name="username" id="username">
		<br /><br />
		Password: <input type="password" name="password" id="password">
		<br /><br />

		<button type="submit" onclick="encrypt_password()">Login</button>
	</form>

	<script src="js/sha256.js"></script>
	<script src="js/rsa.js"></script>
	<script type="text/javascript">

		function encrypt_password() {
			var password = document.getElementById('password').value;
			var hashed_password = SHA256.hash(password);
			var timestamp = Math.floor(new Date().getTime() / 1000);
			var encrypted = RSA_encryption(hashed_password + "&" + timestamp);
			document.getElementById('password').innerHTML = encrypted;
			document.getElementById('password').value = encrypted;
		}

	</script>

	<script type="text/javascript">

		var public_key = "-----BEGIN PUBLIC KEY-----MIIBITANBgkqhkiG9w0BAQEFAAOCAQ4AMIIBCQKCAQBysdE2PPIWEoSsyll2V1mdDs4iw1EpI+UzUXzxrOu48s1/1mK6XRliqFYVcOjRKaQ+aCrb4ae72WFJ0LzKzGj+s7dKzzoAOhv9mFAEnhXrZEwtJcGQsMb40wJi8x6cQJNqSmBiuvBe6ktKbd3XgOxgXe7VHtS/xPSiB9EopCwvr8RvwO0b/JkOqRRMhdCFw0ok6oySKj2RNAjQib1hjM2Yrril4lznvcbqCmWNx+QnTq7+YxBcj459L7Kc6mQdMa7+aypleQLCDpNFsPE0OkfKc8DRQE9BGf8knd1YYFZ0ZxKKTJx8CtazeisE3aRp6s/6q84Jh+WbwQPIMrcZrSxjAgMBAAE=-----END PUBLIC KEY-----";
		function RSA_encryption(message) {

			var encrypt = new JSEncrypt();
			encrypt.setPublicKey(public_key);
			var encrypted = encrypt.encrypt(message);

			return encrypted;
		}

	</script>

</body>

</html>